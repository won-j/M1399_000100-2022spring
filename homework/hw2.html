<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="M1399.000100, Seoul National University, Spring 2022" />
  <title>Homework 2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Homework 2</h1>
<p class="author">M1399.000100, Seoul National University, Spring 2022</p>
<p class="date">Due 23:59 Sunday, 2022-04-24</p>
</header>
<h1 id="m1399.0001000-homework-2-spring-2022-seoul-national-university">M1399.0001000 Homework 2, Spring 2022, Seoul National University</h1>
<p>Due 23:59 2022-04-24</p>
<h4 id="no-late-submission-is-accepted."><strong>No late submission is accepted</strong>.</h4>
<h2 id="q1.-lu-decomposition">Q1. LU decomposition</h2>
<ol type="1">
<li><p>Let <span class="math inline">\(A\in\mathbb{R}^{n\times n}\)</span> be nonsingular. Show that <span class="math inline">\(A\)</span> has an LU decomposition if and only if for each <span class="math inline">\(k\)</span> with <span class="math inline">\(1\le k \le n\)</span>, the upper left <span class="math inline">\(k\times k\)</span> block <code>A[1:k,1:k]</code> is nonsingular. Prove that this LU decomopsition is unique.</p></li>
<li><p>Write an R function <code>LUdecomp</code> with interface <code>r     LUdecomp(obj, tol=1e-8)</code> The decomposition <strong>must</strong> be done <em>in place</em>. That is, if <span class="math inline">\(A=LU \in \mathbb{R}^{n\times n}\)</span>, the <span class="math inline">\(U\)</span> should overwrite the upper triangular part of the input matrix <code>A</code>, and the strictly lower triangular part of <code>A</code> should be overwritten by the same part of the <span class="math inline">\(L\)</span> matrix computed. (Where does the diagonal part of <span class="math inline">\(L\)</span> go?) Since R does not allow in-place modification of atomic objects, you are recommended to use a <a href="http://adv-r.had.co.nz/R5.html">Reference Class</a> (RC) object. The RC for this homework can be declared by <code>r     setRefClass("LUclass",         fields = list(             mat = "matrix",             vec = "vector"         )     )</code> A RC object can be created, for instance, by <code>r     A &lt;- matrix(c(1.0, 0.667, 0.5, 0.333), nrow=2)     b &lt;- c(1.5, 1.0)     obj &lt;- new("LUclass", mat=A, vec=b)</code> Matrix <code>A</code> stored in <code>obj</code> can be referenced by <code>obj$mat</code>, and vector <code>b</code> can be by <code>obj$vec</code> (field <code>vec</code> is reserved for the next question).<br />
<br />
You must also implement partial pivoting: function <code>LUdecomp</code> must return a <code>list</code> that consists of two elements: the first element of the list is the array of the permutation indexes of the rows, and the second element is the indicator of success: if <code>A</code> is (numerically) singular, the function must return the row index where singularity occurs (where may a singularity occur in the LU decomposition?) as the second return value; otherwise return <code>0</code>. Use <code>tol</code> to determine the singularity.</p></li>
<li><p>Using the <code>LUdecomp</code> function written above, write function <code>LUsolve0</code> that solves the linear equation <span class="math inline">\(Ax = b\)</span> with interface</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LUsolve0</span>(obj) </span></code></pre></div>
<p>again <em>in place</em>. That is, in addition to <code>A</code> overwritten by <code>LUdecomp</code>, vector <code>b</code> should be overwritten by the solution <span class="math inline">\(A^{-1}b\)</span>. Then, write a <a href="https://en.wikipedia.org/wiki/Wrapper_function">wrapper function</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LUsolve</span>(A, b)</span></code></pre></div>
<p>which does <strong>not</strong> alter neither <code>A</code> nor <code>b</code> but solves <span class="math inline">\(Ax=b\)</span> by calling <code>LUsolve0</code>. Compare your results with the R expression <code>solve(A, b)</code>.</p></li>
</ol>
<p>Write your functions in a separate <code>.R</code> file within your branch.</p>
<h2 id="q2.-choleksy-decomposition">Q2. Choleksy decomposition</h2>
<ol type="1">
<li><p>심송용, 제 2장 연습문제 2.3</p></li>
<li><p>Complete the <a href="https://github.com/won-j/M1399_000100-2022spring/blob/master/lectures/lecture3/chol.ipynb">proof of the Cholesky decomposition</a> by showing that</p>
<ul>
<li><span class="math inline">\(\mathbf{A}_{22}\)</span> is positive definite, and</li>
<li><span class="math inline">\(\mathbf{A}_{22} - \mathbf{b} \mathbf{b}^T = \mathbf{A}_{22} - a_{11}^{-1} \mathbf{a} \mathbf{a}^T\)</span> is positive definite of size <span class="math inline">\((n-1)\times(n-1)\)</span>.</li>
</ul></li>
</ol>
<h2 id="q3.-qr-decomposition">Q3. QR decomposition</h2>
<ol type="1">
<li><p>심송용, 제 6장 연습문제 6.1, 6.2.</p></li>
<li><p>From the <a href="https://github.com/won-j/M1399_000100-2022spring/blob/master/lectures/lecture4/qr.ipynb">lecture note on QR decompostion</a>, explain why classical Gram-Schmidt (<code>cgs()</code>) fails with the given matrix <code>A</code>.</p></li>
<li><p>From the same lecture note, explain why the modified Gram-Schmidt (<code>mgs()</code>) fails with the given matrix <code>B</code>. Will the classical Gram-Schmidt succeed?</p></li>
<li><p>Implement the Householder QR decomposition in R.</p>
<ul>
<li>The algorithm should be <strong>in-place</strong>: let the <span class="math inline">\(\mathbf{R}\)</span> matrix occupy the upper triangular part of the input <span class="math inline">\(\mathbf{X}\in\mathbf{R}^{n\times p}\)</span>. Below the diagonal place the vectors <span class="math inline">\(\mathbf{u}_k\)</span> that define the Householder transformation matrix <span class="math inline">\(\mathbf{H}_k=\mathbf{I}-2\mathbf{u}_k\mathbf{u}_k^T/\mathbf{u}_k^T\mathbf{u}_k\)</span>. By setting the first element of <span class="math inline">\(\mathbf{u}_k\)</span> to 1, you can fit in these vectors in <span class="math inline">\(\mathbf{X}\)</span>. The algorithm should return an additional vector storing the values of <span class="math inline">\(\mathbf{u}_k^T\mathbf{u}_k\)</span>. This is how the LAPACK routine <code>geqrf</code> is designed. Note that <span class="math inline">\(\mathbf{Q}\)</span> can be recovered from <span class="math inline">\(\mathbf{u}_1, \mathbf{u}_2, \ldots, \mathbf{u}_p\)</span>. The function interface should be</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>householder <span class="ot">&lt;-</span> <span class="cf">function</span>(qrobj)</span></code></pre></div>
<p>taking a <a href="http://adv-r.had.co.nz/R5.html">Reference Class</a> (RC) object</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setRefClass</span>(<span class="st">&quot;QRclass&quot;</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fields =</span> <span class="fu">list</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">mat =</span> <span class="st">&quot;matrix&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">vec =</span> <span class="st">&quot;vector&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Write a separate routine</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>recoverQ <span class="ot">&lt;-</span> <span class="cf">function</span>(qrobj)</span></code></pre></div>
<p> <br />
that recovers <span class="math inline">\(Q\)</span>. (<em>Hint</em>. <!--For $\mathbf{P}_i=\mathbf{I}-2\mathbf{v}_k\mathbf{v}_k^T$ with $\|\mathbf{v}_k\|=1$, $\mathbf{P}_1\mathbf{P}_2 \cdots \mathbf{P}_{n} = \mathbf{I}- \mathbf{V}\mathbf{T}\mathbf{V}^T$, where $\mathbf{V}=[\mathbf{v}_1 | \mathbf{v}_2 | \dotsb | \mathbf{v}_n]$ for some *upper triangular* matrix $\mathbf{T}$.--> <span class="math inline">\(\mathbf{Q}=\mathbf{Q}\mathbf{I}\)</span>.)  </p>
<ul>
<li>Using your function, compute the QR decomposition of the matrices <code>A</code> and <code>B</code> of the previous question. Compare the orthogonality of the computed <span class="math inline">\(Q\)</span> matrix.</li>
</ul></li>
</ol>
<h2 id="q4.-least-squares">Q4. Least squares</h2>
<p>The Longley data set of labor statistics was one of the first used to test accuracy of least squares computations. This data set is available at the <a href="https://www.itl.nist.gov/div898/strd/lls/data/Longley.shtml">National Institute of Standards and Technology (NIST) website</a>, consists of one response variable (number of people employed) and six predictor variables (GNP implicit price deflator, Gross National Product, number of unemployed, number of people in the armed forces, ‘noninstitutionalized’ population <span class="math inline">\(\ge\)</span> 14 years of age, year) observed yearly from 1947 to 1962, and is also available in R package .</p>
<ol type="1">
<li><p>Download the data set from the NIST website, read into R, and construct a data matrix <span class="math inline">\(\mathbf{X}\)</span> for linear model <span class="math inline">\(\mathbf{y}=\mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}\)</span>. Include an intercept in your model.</p>
<ul>
<li>Using the R command <code>svd()</code>, list up the 7 singular values of <span class="math inline">\(\mathbf{X}\)</span>. What is the condition number of <span class="math inline">\(\mathbf{X}\)</span>?</li>
<li>Construct the Gram matrix <span class="math inline">\(\mathbf{G} = \mathbf{X}^T\mathbf{X}\)</span>. List up the 7 singular values of <span class="math inline">\(\mathbf{G}\)</span>. What is the condition number of <span class="math inline">\(\mathbf{G}\)</span>?</li>
</ul></li>
<li><p>Using the function you wrote for Q3, compute the regression coefficients <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, their standard errors, and variance estimate <span class="math inline">\(\hat{\sigma}^2\)</span>. Verify your results using the R function .</p></li>
<li><p>Using the Cholesky decomposition of <span class="math inline">\(\mathbf{G}\)</span>, compute the regression coefficients <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, their standard errors, and variance estimate <span class="math inline">\(\hat{\sigma}^2\)</span>. Compare the results with the values of the above question.</p></li>
</ol>
<h2 id="q5.-iterative-method">Q5. Iterative method</h2>
<ol type="1">
<li><p>Show that the norm <span class="math inline">\(\|\mathbf{x}\|_{\delta}\)</span> in the <a href="https://github.com/won-j/M1399_000100-2022spring/blob/master/lectures/lecture5/iterative.ipynb">lecture note on iterative methods</a> is indeed a vector norm</p></li>
<li><p>심송용, 제 3장 연습문제 3.3.</p></li>
<li><p>Consider solving the linear system of equations <span class="math inline">\(Ax=b\)</span> using Jacobi’s method, where <span class="math display">\[
A = \begin{bmatrix}
 2  &amp; -1      &amp;        &amp;        &amp;  \\
 -1 &amp; 2       &amp; -1     &amp;        &amp;  \\
     &amp; \ddots &amp; \ddots &amp; \ddots &amp;  \\
     &amp;        &amp; -1     &amp; 2      &amp; -1 \\
     &amp;        &amp;        &amp; -1     &amp; 2
\end{bmatrix}
\in \mathbb{R}^{n\times n}.
\]</span> Note the eigenvalues of <span class="math inline">\(A\)</span> are analytically given by <span class="math display">\[
\lambda_i = 2 - 2\cos\frac{i\pi}{n+1}, \quad i = 1, 2, \dotsc, n.
\]</span></p>
<ol type="a">
<li><p>Find the spectral radius of <span class="math inline">\(R\)</span>, when the Jacobi iteration is written as <span class="math display">\[
 x^{(k+1)} = Rx^{(k)} + c.
 \]</span> Will the iterative algorithm converge?</p></li>
<li><p>Let the eigenvector of <span class="math inline">\(A\)</span> associated with the eigenvalue <span class="math inline">\(\lambda_i\)</span> be <span class="math inline">\(v_i \in \mathbb{R}^n\)</span>. Then we can express the error of the iteration as <span class="math display">\[
 \varepsilon^{(k)} := x^{(k)} - x^* = a^{(k)}_1v_1 + a^{(k)}_2v_2 + \dotsb + a^{(k)}_nv_n,
 \]</span> for some scalars <span class="math inline">\(a^{(k)}_1,\dotsc,a^{(k)}_n\)</span>; <span class="math inline">\(x^*\)</span> is the true solution of <span class="math inline">\(Ax=b\)</span>. What can you say about the attenuation of the sequence <span class="math inline">\(\{a^{(k)}_i\}_{k=1,2,\dotsc}\)</span> for different values of <span class="math inline">\(i\)</span>?</p></li>
</ol></li>
</ol>
</body>
</html>
